import{r as x,R as C,j as e}from"./index-BgaYWGxT.js";const L=()=>{const[m,E]=x.useState(5),[f,w]=x.useState([]),[j,g]=x.useState([]),[p,k]=x.useState({}),[O,y]=x.useState(""),[N,v]=x.useState(!1);C.useEffect(()=>{if(m>0){const t=Array(m).fill("").map((r,s)=>`User ${s+1}`);w(t);const l=Array(m).fill().map(()=>Array(m).fill(!1));g(l)}},[m]);const S=(t,l)=>{const r=[...f];r[t]=l,w(r)},b=(t,l)=>{if(t===l)return;const r=[...j];r[t][l]=!r[t][l],g(r)},F=()=>{v(!0),y("");try{const t=f.map((a,i)=>({id:i.toString(),label:a})),l=[];if(j.forEach((a,i)=>{a.forEach((c,n)=>{c&&l.push({from:i.toString(),to:n.toString()})})}),t.length===0||l.length===0)throw new Error("Please define some relationships before analyzing");const r=t.length,s={};t.forEach(a=>{s[a.id]={inDegree:0,outDegree:0,betweenness:0,closeness:0,eigenvector:0,pagerank:0}}),l.forEach(a=>{s[a.to].inDegree++,s[a.from].outDegree++}),t.forEach(a=>{const i={popularity:s[a.id].inDegree/(r-1),infoBroker:A(a.id,l,t),networkReach:R(a.id,l,t),powerScore:P(a.id,l,t),authority:M(a.id,l,t)},c=.3*i.powerScore+.3*i.authority+.2*i.infoBroker+.1*i.popularity+.1*i.networkReach;s[a.id]={...i,overallInfluence:c}}),k(s),v(!1)}catch(t){y(t.message),v(!1)}},U=(t,l,r)=>{const s=[],a=new Set,i=(n,d,o)=>{if(n===d){s.push([...o]);return}a.add(n),r[n].forEach(h=>{a.has(h)||(o.push(h),i(h,d,o),o.pop())}),a.delete(n)};i(t,l,[t]);const c=Math.min(...s.map(n=>n.length));return s.filter(n=>n.length===c)},A=(t,l,r)=>{const s=r.length;let a=0;const i={};return r.forEach(c=>{i[c.id]=[]}),l.forEach(c=>{i[c.from].push(c.to),i[c.to].push(c.from)}),r.forEach(c=>{c.id!==t&&r.forEach(n=>{if(n.id!==t&&n.id!==c.id){const d=U(c.id,n.id,i);if(d.length>0){const o=d.filter(h=>h.includes(t));a+=o.length/d.length}}})}),a/((s-1)*(s-2)/2)},R=(t,l,r)=>{const s={};r.forEach(o=>s[o.id]=1/0),s[t]=0;const a=[t],i=new Set([t]),c={};for(r.forEach(o=>{c[o.id]=[]}),l.forEach(o=>{c[o.from].push(o.to)});a.length>0;){const o=a.shift();c[o].forEach(h=>{i.has(h)||(i.add(h),s[h]=s[o]+1,a.push(h))}),l.filter(h=>h.to===o).forEach(h=>{const u=h.from;i.has(u)||(i.add(u),s[u]=s[o]+1,a.push(u))})}const n=Object.values(s).filter(o=>o!==1/0).length;if(n<r.length)return 0;const d=Object.values(s).reduce((o,h)=>o+h,0);return(n-1)/d},P=(t,l,r)=>{const s={};r.forEach(i=>{s[i.id]={},r.forEach(c=>{s[i.id][c.id]=0})}),l.forEach(i=>{s[i.from][i.to]=1});let a={};r.forEach(i=>{a[i.id]=1});for(let i=0;i<50;i++){const c={};let n=0;r.forEach(o=>{let h=0;r.forEach(u=>{h+=s[u.id][o.id]*a[u.id]}),c[o.id]=h,n+=h*h});const d=Math.sqrt(n);if(d===0)return 0;r.forEach(o=>{a[o.id]=c[o.id]/d})}return a[t]},M=(t,l,r)=>{const a={},i={};r.forEach(n=>{a[n.id]={},i[n.id]=0,r.forEach(d=>{a[n.id][d.id]=0})}),l.forEach(n=>{a[n.from][n.to]=1,i[n.from]++});let c={};r.forEach(n=>{c[n.id]=1/r.length});for(let n=0;n<50;n++){const d={};r.forEach(o=>{let h=0;r.forEach(u=>{a[u.id][o.id]===1&&(h+=c[u.id]/i[u.id])}),d[o.id]=(1-.85)/r.length+.85*h}),c={...d}}return c[t]},B=t=>{const{popularity:l,infoBroker:r,networkReach:s,powerScore:a,authority:i}=t;return[{value:l,role:"Popular User (high direct connections)"},{value:r,role:"Information Broker (connects different groups)"},{value:s,role:"Network Hub (high reach)"},{value:a,role:"Power User (connected to important users)"},{value:i,role:"Authority (trusted by network)"}].reduce((n,d)=>d.value>n.value?d:n).role},D=()=>e.jsxs("div",{className:"follow-matrix",children:[e.jsx("h3",{children:"Who follows whom?"}),e.jsx("p",{children:"Click on cells to toggle follow relationships"}),e.jsxs("div",{className:"matrix-container",children:[e.jsxs("div",{className:"matrix-header",children:[e.jsx("div",{className:"matrix-cell header-cell"}),f.map((t,l)=>e.jsx("div",{className:"matrix-cell header-cell",children:t},l))]}),f.map((t,l)=>e.jsxs("div",{className:"matrix-row",children:[e.jsx("div",{className:"matrix-cell header-cell",children:t}),f.map((r,s)=>e.jsx("div",{className:`matrix-cell ${l===s?"self-cell":""} ${j[l][s]?"follows":""}`,onClick:()=>b(l,s),children:l===s?"—":j[l][s]?"✓":""},s))]},l))]})]}),$=t=>{if(!t||Object.keys(t).length===0)return null;const l=Object.entries(t).sort(([,r],[,s])=>(s.overallInfluence||0)-(r.overallInfluence||0));return e.jsxs("div",{className:"influencers-section",children:[e.jsx("h3",{children:"Top Influencers Analysis"}),e.jsx("div",{className:"influencers-list",children:l.map(([r,s])=>s?e.jsxs("div",{className:"influencer-card",children:[e.jsx("h4",{children:f[parseInt(r)]||`User ${parseInt(r)+1}`}),e.jsx("div",{className:"primary-role",children:B(s)}),e.jsxs("div",{className:"metrics-breakdown",children:[e.jsx("h5",{children:"Influence Metrics:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("span",{children:"Popularity:"}),e.jsx("span",{children:(s.popularity||0).toFixed(4)})]}),e.jsxs("li",{children:[e.jsx("span",{children:"Information Broker:"}),e.jsx("span",{children:(s.infoBroker||0).toFixed(4)})]}),e.jsxs("li",{children:[e.jsx("span",{children:"Network Reach:"}),e.jsx("span",{children:(s.networkReach||0).toFixed(4)})]}),e.jsxs("li",{children:[e.jsx("span",{children:"Power Score:"}),e.jsx("span",{children:(s.powerScore||0).toFixed(4)})]}),e.jsxs("li",{children:[e.jsx("span",{children:"Authority:"}),e.jsx("span",{children:(s.authority||0).toFixed(4)})]})]})]}),e.jsxs("div",{className:"overall-score",children:["Overall Influence: ",(s.overallInfluence||0).toFixed(4)]})]},r):null)})]})};return e.jsxs("div",{className:"simulation8-container",children:[e.jsxs("div",{className:"num-users-section",children:[e.jsx("label",{htmlFor:"numUsers",children:"Number of Users:"}),e.jsx("input",{type:"number",id:"numUsers",value:m,onChange:t=>E(Math.max(1,Math.min(10,parseInt(t.target.value)||0))),min:"1",max:"10"})]}),e.jsxs("div",{className:"user-input-section",children:[e.jsx("h2",{children:"User Names"}),e.jsx("div",{className:"user-names-grid",children:f.map((t,l)=>e.jsxs("div",{className:"user-name-input",children:[e.jsx("label",{htmlFor:`user-${l}`,children:`User ${l+1}:`}),e.jsx("input",{type:"text",id:`user-${l}`,value:t,onChange:r=>S(l,r.target.value),placeholder:`User ${l+1}`})]},l))})]}),e.jsx("div",{className:"follow-matrix",children:D()}),e.jsx("button",{className:"analyze-button",onClick:F,disabled:N,children:N?"Analyzing...":"Analyze Network"}),Object.keys(p).length>0&&e.jsxs(e.Fragment,{children:[$(p),e.jsxs("div",{className:"metrics-summary",children:[e.jsx("h3",{children:"Detailed Network Analysis"}),e.jsx("div",{className:"metrics-summary-table-container",children:e.jsxs("table",{className:"metrics-summary-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Popularity"}),e.jsx("th",{children:"Info Broker"}),e.jsx("th",{children:"Network Reach"}),e.jsx("th",{children:"Power Score"}),e.jsx("th",{children:"Authority"})]})}),e.jsx("tbody",{children:f.map((t,l)=>{const r=p[l.toString()]||{};return e.jsxs("tr",{children:[e.jsx("td",{children:t}),e.jsx("td",{children:(r.popularity||0).toFixed(4)}),e.jsx("td",{children:(r.infoBroker||0).toFixed(4)}),e.jsx("td",{children:(r.networkReach||0).toFixed(4)}),e.jsx("td",{children:(r.powerScore||0).toFixed(4)}),e.jsx("td",{children:(r.authority||0).toFixed(4)})]},l)})})]})})]})]})]})};export{L as default};
