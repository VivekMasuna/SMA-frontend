import{r as d,u as q,j as e,L as m,a as E}from"./index-nhX6UiO_.js";const w=()=>{const[h,N]=d.useState({}),[y,x]=d.useState(!0),[g,c]=d.useState(null),o=q(),u={1:"Bernoulli's Principle",2:"Web Scraping",3:"Sentiment Analysis",4:"Topic Modeling",5:"Graph Traversal",6:"Social Network Analysis",7:"Network Centrality",8:"Community Detection"};d.useEffect(()=>{(async()=>{var t;try{x(!0);const r=await E.get("https://sma-vlab-backend.kjsieit.com/api/quiz-scores",{withCredentials:!0,headers:{"Content-Type":"application/json"}});if(r.data&&r.data.success){const n={};Object.keys(u).forEach(i=>{n[i]=[]}),r.data.data.forEach(i=>{n[i.experimentNo]&&(n[i.experimentNo].push(i),n[i.experimentNo].sort((p,Q)=>new Date(Q.completedAt)-new Date(p.completedAt)))}),N(n)}else c("Failed to fetch quiz scores")}catch(a){console.error("Error fetching quiz scores:",a),a.response?a.response.status===401?o("/login"):a.response.status===404?c("Quiz scores service is currently unavailable"):c(`Failed to fetch quiz scores: ${((t=a.response.data)==null?void 0:t.message)||"Unknown error"}`):c("Failed to connect to the server. Please try again later.")}finally{x(!1)}})()},[o]);const b=s=>{const t={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0};return new Date(s).toLocaleDateString(void 0,t)},z=s=>u[s]||`Experiment ${s}`,f=s=>{o(`/experiment/${s}?section=Quiz`)},j=s=>s.length===0?0:Math.max(...s.map(t=>t.score/t.totalQuestions*100)),S=s=>s.length===0?0:s.reduce((a,r)=>a+r.score/r.totalQuestions*100,0)/s.length,v=s=>({"--progress":`${s}%`}),k=()=>{const s=Object.keys(u).length,t=Object.values(h).filter(i=>i.length>0).length,a=t/s*100,n=Object.values(h).reduce((i,p)=>i+j(p),0)/s;return{attempted:t,total:s,percentage:a,averageScore:n}};if(y)return e.jsxs("div",{className:"quiz-history-container",children:[e.jsx("h2",{children:"Quiz Dashboard"}),e.jsx("div",{className:"quiz-history-loading",children:"Loading quiz history..."})]});if(g)return e.jsxs("div",{className:"quiz-history-container",children:[e.jsx("h2",{children:"Quiz Dashboard"}),e.jsx("div",{className:"quiz-history-error",children:g})]});const l=k();return e.jsxs("div",{children:[e.jsxs("nav",{className:"navbar",children:[e.jsxs("div",{className:"navbar-left",children:[e.jsx("img",{src:"https://kjsieit.somaiya.edu.in/assets/kjsieit/images/Logo/Somaiya-Logo.svg",alt:"Somaiya Logo",className:"nav-logo"}),e.jsx("span",{className:"college-name",children:"K J Somaiya Institute of Technology"})]}),e.jsxs("div",{className:"navbar-right",children:[e.jsx(m,{to:"/",className:"nav-link",children:"Home"}),e.jsx(m,{to:"/about",className:"nav-link",children:"About"}),e.jsx(m,{to:"/experiments",className:"nav-link",children:"Experiments"}),e.jsx(m,{to:"/quiz-history",className:"nav-link active",children:"Quiz History"}),e.jsx("button",{onClick:()=>o("/logout"),className:"logout-btn",children:"Logout"})]})]}),e.jsxs("div",{className:"quiz-history-container",children:[e.jsx("h2",{children:"Quiz Dashboard"}),e.jsxs("div",{className:"overall-progress",children:[e.jsxs("div",{className:"progress-header",children:[e.jsx("h3",{children:"Overall Progress"}),e.jsxs("div",{className:"progress-circle large",style:v(l.percentage),children:[e.jsxs("span",{className:"progress-value",children:[l.percentage.toFixed(0),"%"]}),e.jsx("span",{className:"progress-label",children:"Complete"})]})]}),e.jsxs("div",{className:"progress-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsxs("span",{className:"stat-value",children:[l.attempted,"/",l.total]}),e.jsx("span",{className:"stat-label",children:"Experiments Attempted"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsxs("span",{className:"stat-value",children:[l.averageScore.toFixed(1),"%"]}),e.jsx("span",{className:"stat-label",children:"Average Best Score"})]})]})]}),e.jsx("div",{className:"quiz-dashboard-grid",children:Object.entries(h).map(([s,t])=>{const a=j(t);return e.jsxs("div",{className:`experiment-card ${t.length===0?"not-attempted":""}`,children:[e.jsxs("div",{className:"experiment-header",children:[e.jsx("h3",{children:z(parseInt(s))}),e.jsx("div",{className:"progress-circle",style:v(a),children:e.jsxs("span",{className:"progress-value",children:[a.toFixed(0),"%"]})})]}),e.jsxs("div",{className:"score-summary",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Attempts"}),e.jsx("span",{className:"summary-value",children:t.length})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Best Score"}),e.jsxs("span",{className:"summary-value",children:[a.toFixed(1),"%"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{className:"summary-label",children:"Average"}),e.jsxs("span",{className:"summary-value",children:[S(t).toFixed(1),"%"]})]})]}),t.length>0?e.jsxs("div",{className:"attempt-list",children:[e.jsx("h4",{children:"Recent Attempts"}),t.slice(0,3).map((r,n)=>e.jsx("div",{className:"attempt-item",children:e.jsxs("div",{className:"attempt-info",children:[e.jsx("span",{className:"attempt-date",children:b(r.completedAt)}),e.jsxs("span",{className:"attempt-score",children:[r.score,"/",r.totalQuestions," (",(r.score/r.totalQuestions*100).toFixed(1),"%)"]})]})},r._id||n))]}):e.jsxs("div",{className:"no-attempts",children:[e.jsx("p",{children:"No attempts yet"}),e.jsx("p",{children:"Take this quiz to test your knowledge!"})]}),e.jsx("button",{className:"retake-quiz-button",onClick:()=>f(parseInt(s)),children:t.length>0?"Retake Quiz":"Start Quiz"})]},s)})})]})]})};export{w as default};
